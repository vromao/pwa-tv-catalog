!function(e){"function"==typeof define&&define.amd?define("app",e):e()}((function(){"use strict";const e="588ec4afaef59a5e2eb312e64af3630e";function t(e){fetch(e.url).then(e=>{caches.open("pwa-tv-catalog-api-requests").then(t=>{t.put(e.url,e)})})}const a={getMoviesList:()=>fetch(`https://api.themoviedb.org/3/movie/top_rated?api_key=${e}&language=en-US&adult=false&page=1`).then(e=>(t(e),e.json())),getSeriesList:()=>fetch(`https://api.themoviedb.org/3/tv/top_rated?api_key=${e}&language=en-US&adult=false&page=1`).then(e=>(t(e),e.json())),getMovie:a=>fetch(`https://api.themoviedb.org/3/movie/${a}?api_key=${e}&language=en-US&adult=false&page=1`).then(e=>(t(e),e.json())),getSerie:a=>fetch(`https://api.themoviedb.org/3/tv/${a}?api_key=${e}&language=en-US&adult=false&page=1`).then(e=>(t(e),e.json()))};class i{constructor(){this.backgroundSize=500,this.posterSize=200,this.roundAverageVote=0}initDetails(e,t){this.roundAverageVote=10*t.vote_average,this._detailsContainer=document.querySelector(e),this._detailsContainer.innerHTML="",this._detailsContainer.insertAdjacentHTML("beforeend",this._template(t)),document.querySelector("#nav-home-link").textContent="Voltar"}cacheImages(e){const t=`https://image.tmdb.org/t/p/w${this.backgroundSize}${e.backdrop_path}`;fetch(t).then(e=>{caches.open("pwa-tv-catalog-images").then(a=>{a.put(t,e)})})}_template(e){return`\n            <section class="detailsPage-section">\n                <div class="detailsPage-section__img-container">\n                    <img src="https://image.tmdb.org/t/p/w${this.backgroundSize}${e.backdrop_path}" alt="PWA TV Catalog - ${e.original_title||e.name}" class="detailsPage-section__img mb--24">\n                </div>\n                <div class="detailsPage-section__infos">\n                    <h2 class="page-title mb--16">${e.title||e.name}</h2>\n\n                    <h3 class="page-subtitle mb--16">Overview</h3>\n                    <p>${e.overview}</p>\n                    \n                    <hr class="divider">\n                    \n                    <div class="info-list-container">\n                        <ul class="info-list mb--24">\n                            <h3 class="page-subtitle mb--16">Infos</h3>\n                            <li><span class="info-list__bold-typo">Release:</span> ${e.release_date||e.first_air_date}</li>\n                            <li><span class="info-list__bold-typo">Status:</span> ${e.status}</li>\n                            ${e.number_of_episodes?`\n                                <li><span class="info-list__bold-typo">Episodes:</span> ${e.number_of_episodes}</li>\n                                <li><span class="info-list__bold-typo">Seasons:</span> ${e.number_of_seasons}</li>\n                            `:""}\n                            <li><span class="info-list__bold-typo">Score:</span> ${this.roundAverageVote}% approved (TMDB based)</li>\n\n                        </ul>\n                        <div class="info-list-container-img-poster">\n                            <img src="https://image.tmdb.org/t/p/w${this.posterSize}${e.poster_path}" alt="PWA TV Catalog - ${e.original_title||e.name}" class="detailsPage-section__im">\n                        </div>\n                    </div>\n                </div>\n            </section>\n        `}}class s{constructor(e){this.posterSize=200,this.catalogItems=4,this._catalogContainer=document.querySelector(e),document.querySelector("#nav-home-link").textContent="Home",this._catalogContainer.innerHTML=""}loadMovies(){a.getMoviesList().then(e=>{this.cacheImages(e),this._catalogContainer.insertAdjacentHTML("beforeend",this._template(e.results,"movie"))})}loadSeries(){a.getSeriesList().then(e=>{this.cacheImages(e),this._catalogContainer.insertAdjacentHTML("beforeend",this._template(e.results,"serie"))})}loadCatalog(){this.loadMovies(),this.loadSeries()}cacheImages(e){e.results.forEach(e=>{const t=`https://image.tmdb.org/t/p/w${this.posterSize}${e.poster_path}`;fetch(t).then(e=>{caches.open("pwa-tv-catalog-images").then(a=>{a.put(t,e)})})})}_template(e,t){return this.moviesLoad&&this.seriesLoad&&this.loading&&this.loading.classList.remove("all-loading"),`\n            <section class="catalog-section container">\n                <h2 class="catalog-section__title">${t}s</h2>\n                ${e.slice(0,this.catalogItems).map(e=>`\n                    <a id="card-link" class="card-link" href="#/details/${t}?id=${e.id}">\n                        <div class="card">\n                            <img src="https://image.tmdb.org/t/p/w${this.posterSize}${e.poster_path}" alt="PWA TV Catalog - ${e.original_title||e.name}" class="card-img">\n                            <div class="card__overlay">\n                                <h2 class="card__title">${e.title||e.name}</h2>\n                                <p class="card__overview">${e.overview}</p>\n                                <span class="card__details">See more</span>\n                            </div>\n                        </div>\n                    </a>\n                `).join("")}\n            </section>\n        `}}const n=e=>{document.body.addEventListener("click",t=>{if(t.defaultPrevented||0!==t.button||t.metaKey||t.ctrlKey||t.shiftKey)return;const a=t.composedPath().filter(e=>"A"===e.tagName)[0];if(!a||a.target||a.hasAttribute("download")||"external"===a.getAttribute("rel"))return;const i=a.href;if(!i||-1!==i.indexOf("mailto:"))return;const s=window.location,n=s.origin||s.protocol+"//"+s.host;0===i.indexOf(n)&&(t.preventDefault(),i!==s.href&&(window.history.pushState({},"",i),e(s,t)))}),window.addEventListener("popstate",t=>e(window.location,t)),e(window.location,null)};"serviceWorker"in navigator&&navigator.serviceWorker.register("service-worker.js"),(new class{initRoute(){n(e=>this._handleNavigation(e))}_handleNavigation(e){const t=e.hash;if(t){const e=/\d+/g.exec(t)[0];this.matchUrl(t,"details/movie")&&a.getMovie(e).then(e=>{(new i).initDetails("#app",e),window.scrollTo(0,0)}),this.matchUrl(t,"details/serie")&&a.getSerie(e).then(e=>{(new i).initDetails("#app",e),window.scrollTo(0,0)})}else{new s("#app").loadCatalog()}}matchUrl(e,t){return-1!==e.indexOf(t)}}).initRoute()}));